# Rest API 기반 쇼핑몰 프로젝트입니다.
테스트 코드를 기반으로 로직을 검증하며, 
PostMan을 통해서 실제 URL에서 어떤 JSON 값을 리턴하는 지 테스트했습니다.

## 사용 기술
Spring Boot 3 / Spring Data JPA / QueryDSL / MYSQL/ Lombok

## 기능 목록
회원 기능
1. 회원가입
2. 로그인
3. 회원탈퇴
   - 탈퇴 회원은 MemberState(Enum class)를 변경
5. 회원 상태 변경
    - 관리자 전용
   
상품 관련
1. 상품 등록 / 수정 / 삭제
2. 상품 검색
3. 전체 상품 조회
4. 카테고리 등록
5. 전체 카테고리 조회

주문 관련
1. 주문 생성 / 주문 상태 변경 / 주문 취소
2. 하나의 주문 상품 정보 조회
3. 한 사람의 전체 주문 조회
4. 전체 주문 조회(관리자)

장바구니
1. 회원가입 시 장바구니 동시 생성
2. 회원 장바구니 목록 조회

상품 리뷰
1. 상품 리뷰 생성 / 수정/ 삭제
2. 한 회원은 하나의 상품에 대한 리뷰는 한 개씩만 1:1로 작성할 수 있다.
3. 리뷰는 페이지당 15개씩 불러오고, 페이징 메소드를 통해서 관리하며,
임의의 버튼을 누르면 1~15번 리뷰에서 16~30번 리뷰로 넘어가도록 구상하였다.

응답 및 예외 처리
공통 응답은 ApiResponse로 관리하며, 에러는 ErrorCode를 통해서 통합 관리한다.
잘못된 접근 등은 BadRequestException, 쇼핑몰 내부 비즈니스적 오류는 BusinessError를 리턴하는 등 
각 메세지의 에러 상태를 커스텀하여 관리한다.

![eer](https://github.com/user-attachments/assets/607f5d11-6356-44b3-8f71-1c52d53bead7)

API 명세서
[Uploading API 명세서.html…](
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>CofShop API Docs</title>
  <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist/swagger-ui.css" />
  <style>
    html { box-sizing: border-box; overflow-y: scroll; }
    *, *:before, *:after { box-sizing: inherit; }
    body { margin: 0; background: #fafafa; }
  </style>
</head>
<body>
  <div id="swagger-ui"></div>
  <script src="https://unpkg.com/swagger-ui-dist/swagger-ui-bundle.js"></script>
  <script>
    window.onload = function() {
      const spec = {"openapi": "3.0.1", "info": {"title": "CofShop API Test Doc", "description": "쇼핑몰 Rest API 명세서입니다.", "version": "1.0.0"}, "servers": [{"url": "http://localhost:8080", "description": "Generated server url"}], "paths": {"/api/reviews/{reviewId}": {"put": {"tags": ["review-controller"], "summary": "리뷰 수정", "description": "등록했던 리뷰 정보를 변경합니다.", "operationId": "updateReview", "parameters": [{"name": "reviewId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/ReviewRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseReviewResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "delete": {"tags": ["review-controller"], "summary": "리뷰 삭제", "description": "리뷰를 삭제합니다.", "operationId": "deleteReview", "parameters": [{"name": "reviewId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/item/{itemId}": {"get": {"tags": ["item-controller"], "summary": "상품 정보 조회", "description": "조회 결과", "operationId": "inquiryItem", "parameters": [{"name": "itemId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "put": {"tags": ["item-controller"], "summary": "상품 정보 수정", "description": "상품 정보를 수정합니다.", "operationId": "updateItem", "parameters": [{"name": "itemId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "requestBody": {"content": {"application/json": {"schema": {"required": ["images", "itemRequestDto"], "type": "object", "properties": {"itemRequestDto": {"$ref": "#/components/schemas/ItemUpdateRequestDto"}, "images": {"type": "array", "items": {"type": "string", "format": "binary"}}}}}}}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "delete": {"tags": ["item-controller"], "summary": "상품 삭제", "description": "상품 정보를 삭제합니다.", "operationId": "deleteItem", "parameters": [{"name": "itemId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/reviews/items/{itemId}": {"get": {"tags": ["review-controller"], "summary": "리뷰 목록 조회", "description": "조회 결과", "operationId": "reviewList", "parameters": [{"name": "itemId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "pageable", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/Pageable"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponsePageReviewResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "post": {"tags": ["review-controller"], "summary": "리뷰 등록", "description": "한 상품에 리뷰를 등록합니다.", "operationId": "addReview", "parameters": [{"name": "itemId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/ReviewRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseReviewResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/orders": {"get": {"tags": ["order-controller"], "summary": "주문 전체 조회", "description": "관리자 전용입니다, 전체 주문 정보를 조회합니다.", "operationId": "getAllOrders", "parameters": [{"name": "pageable", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/Pageable"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponsePageOrderResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "post": {"tags": ["order-controller"], "summary": "주문 생성", "description": "상품 주문 정보를 생성합니다.", "operationId": "createOrder", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/OrderRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseOrderResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/signup": {"post": {"tags": ["member-controller"], "summary": "회원가입", "description": "회원가입 기능입니다.", "operationId": "signup", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/MemberRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseMemberResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/memberCoupon/me/{couponId}": {"post": {"tags": ["member-coupon-controller"], "summary": "쿠폰 발급", "description": "사용자에게 쿠폰을 발급합니다.", "operationId": "createMemberCoupon", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}, {"name": "couponId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseMemberCouponResponseDto"}}}}}}}, "/api/item": {"post": {"tags": ["item-controller"], "summary": "상품 등록", "description": "판매상품을 등록합니다.", "operationId": "uploadItem", "requestBody": {"content": {"application/json": {"schema": {"required": ["images", "itemRequestDto"], "type": "object", "properties": {"itemRequestDto": {"$ref": "#/components/schemas/ItemRequestDto"}, "images": {"type": "array", "items": {"type": "string", "format": "binary"}}}}}}}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/item/search": {"post": {"tags": ["item-controller"], "summary": "상품 검색", "description": "검색 결과", "operationId": "searchItems", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/ItemSearchRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponsePageItemSearchResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/coupon": {"get": {"tags": ["coupon-controller"], "summary": "쿠폰 전체 조회", "description": "현재 생성되어있는 전체 쿠폰을 조회합니다.", "operationId": "getAllCoupons", "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCouponResponseDto"}}}}}}, "post": {"tags": ["coupon-controller"], "summary": "쿠폰 생성", "description": "쿠폰을 생성합니다.", "operationId": "createCoupon", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/CouponRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseCouponResponseDto"}}}}}}}, "/api/coupon/expire": {"post": {"tags": ["coupon-controller"], "summary": "쿠폰 만료", "description": "관리자 전용입니다, 직접 쿠폰의 상태를 만료시킵니다.", "operationId": "expireCoupons", "parameters": [{"name": "date", "in": "query", "required": true, "schema": {"type": "string", "format": "date"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseVoid"}}}}}}}, "/api/chat-rooms": {"post": {"tags": ["chat-room-controller"], "summary": "채팅방 생성", "description": "고객센터 1:1 채팅방을 생성합니다.", "operationId": "createChatRoom", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseChatRoomResponseDto"}}}}}}}, "/api/categories": {"get": {"tags": ["category-controller"], "summary": "전체 카테고리 조회", "description": "전체 카테고리를 조회합니다.", "operationId": "getAllCategories", "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCategoryResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "post": {"tags": ["category-controller"], "summary": "카테고리 등록", "description": "관리자 전용입니다.", "operationId": "createCategory", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/CategoryRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseCategoryResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/carts/me": {"post": {"tags": ["cart-controller"], "summary": "장바구니 생성", "description": "장바구니를 생성합니다.", "operationId": "createCart", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseCartResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/cart-items/me/items": {"post": {"tags": ["cart-item-controller"], "summary": "장바구니 상품 등록(단일)", "description": "장바구니에 상품을 추가합니다.", "operationId": "addCartItem", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/CartItemRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseCartItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}, "delete": {"tags": ["cart-item-controller"], "operationId": "deleteAllCartItems", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/cart-items/me/items/list": {"post": {"tags": ["cart-item-controller"], "summary": "장바구니 상품 등록(복수)", "description": "장바구니에 상품을 추가합니다.", "operationId": "addCartItemBulk", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "requestBody": {"content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/CartItemRequestDto"}}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCartItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/auth/reissue": {"post": {"tags": ["auth-controller"], "summary": "RefreshToken 재발급", "description": "1시간 단위로 RefreshToken을 재발급합니다..", "operationId": "reissue", "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/TokenDto"}}}}}}}, "/api/orders/{orderId}/confirm": {"patch": {"tags": ["order-controller"], "summary": "구매 확정", "description": "배송 완료된 상품의 구매를 확정합니다.", "operationId": "confirmPurchase", "parameters": [{"name": "orderId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseVoid"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/orders/{orderId}/cancel": {"patch": {"tags": ["order-controller"], "summary": "주문 취소", "description": "상품의 주문을 취소합니다.", "operationId": "cancelOrder", "parameters": [{"name": "orderId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/OrderCancelRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseOrderCancelResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/{memberId}/state": {"patch": {"tags": ["member-controller"], "summary": "멤버 상태 변경", "description": "관리자 전용, 멤버 상태 변경 기능입니다.", "operationId": "updateMemberStateByAdmin", "parameters": [{"name": "memberId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "memberState", "in": "query", "required": true, "schema": {"type": "string", "enum": ["QUIT", "ACTIVE", "SUSPENDED"]}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseString"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/{memberId}/point": {"patch": {"tags": ["member-controller"], "summary": "포인트 변경", "description": "회원의 포인트를 변경합니다.", "operationId": "updatePoint", "parameters": [{"name": "memberId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "amount", "in": "query", "required": true, "schema": {"type": "integer", "format": "int32"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseInteger"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/me/state": {"patch": {"tags": ["member-controller"], "summary": "회원탈퇴", "description": "회원탈퇴 기능입니다.", "operationId": "quitMember", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseString"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/me/password": {"patch": {"tags": ["member-controller"], "summary": "비밀번호 변경", "description": "회원의 비밀번호를 변경합니다.", "operationId": "changePassword", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}, {"name": "password", "in": "query", "required": true, "schema": {"type": "string"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseString"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/memberCoupon/expire": {"patch": {"tags": ["member-coupon-controller"], "summary": "쿠폰 만료", "description": "회원의 쿠폰 상태를 만료 상태로 변경합니다.", "operationId": "expireMemberCoupons", "parameters": [{"name": "date", "in": "query", "required": true, "schema": {"type": "string", "format": "date"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseVoid"}}}}}}}, "/api/coupon/{couponId}/state": {"patch": {"tags": ["coupon-controller"], "summary": "쿠폰 상태 변경", "description": "쿠폰의 사용가능 여부를 변경합니다.", "operationId": "updateCouponState", "parameters": [{"name": "couponId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "newState", "in": "query", "required": true, "schema": {"type": "string", "enum": ["AVAILABLE", "USED", "EXPIRED", "CANCELLED"]}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseVoid"}}}}}}}, "/api/coupon/{couponId}/cancel": {"patch": {"tags": ["coupon-controller"], "summary": "쿠폰 발급 취소", "description": "쿠폰을 발급 불가능 상태로 변경합니다.", "operationId": "cancelCoupon", "parameters": [{"name": "couponId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseVoid"}}}}}}}, "/api/chat-rooms/{roomId}/join": {"patch": {"tags": ["chat-room-controller"], "summary": "상담사 연결", "description": "채팅방에 상담사를 배정합니다.", "operationId": "joinChatAgent", "parameters": [{"name": "roomId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "agentId", "in": "query", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}}}, "/api/chat-rooms/{roomId}/close": {"patch": {"tags": ["chat-room-controller"], "summary": "상담 종료", "description": "상담이 완료되었을 때, 채팅방을 종료합니다.", "operationId": "closeChatRoom", "parameters": [{"name": "roomId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}}}, "/api/cart-items/me/quantity": {"patch": {"tags": ["cart-item-controller"], "summary": "장바구니 상품 수량 변경", "description": "장바구니의 상품 수량을 변경합니다.", "operationId": "updateQuantity", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/CartItemRequestDto"}}}, "required": true}, "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/statistics/sales-between": {"get": {"tags": ["statistics-controller"], "summary": "기간 별 판매량 순으로 상품 조회", "description": "기간 별로 팔린 상품들의 정보를 조회합니다.", "operationId": "getSalesBetween", "parameters": [{"name": "start", "in": "query", "required": true, "schema": {"type": "string", "format": "date"}}, {"name": "end", "in": "query", "required": true, "schema": {"type": "string", "format": "date"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListDailySalesDto"}}}}}}}, "/api/statistics/last-7days": {"get": {"tags": ["statistics-controller"], "summary": "최근 7일 간 인기상품 조회", "description": "최근 7일 동안 많이 팔린 상품을 10개 조회합니다.", "operationId": "getTopItemsLast7Days", "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListTopItemDto"}}}}}}}, "/api/statistics/daily-sales": {"get": {"tags": ["statistics-controller"], "summary": "하루 상품 판매량 조회", "description": "하루의 판매량을 조회합니다.", "operationId": "getDailySales", "parameters": [{"name": "date", "in": "query", "required": true, "schema": {"type": "string", "format": "date"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListDailySalesDto"}}}}}}}, "/api/payments/{impUid}": {"get": {"tags": ["payment-controller"], "operationId": "getPaymentInfo", "parameters": [{"name": "impUid", "in": "path", "required": true, "schema": {"type": "string"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponsePayment"}}}}}}}, "/api/orders/{orderId}": {"get": {"tags": ["order-controller"], "summary": "상품 주문 정보 조회", "description": "하나의 상품의 주문정보를 조회합니다.", "operationId": "getOrderInfo", "parameters": [{"name": "orderId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseOrderResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/orders/me": {"get": {"tags": ["order-controller"], "summary": "한 사람의 주문 전체 조회", "description": "구매한 모든 상품의 주문정보를 조회합니다.", "operationId": "getMyOrders", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}, {"name": "pageable", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/Pageable"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponsePageOrderResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members": {"get": {"tags": ["member-controller"], "summary": "전체 멤버 조회", "description": "관리자 전용, 모든 멤버를 조회합니다.", "operationId": "getAllMembers", "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListMemberResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/{memberId}": {"get": {"tags": ["member-controller"], "summary": "회원 정보 열람", "description": "회원의 정보를 열람합니다.", "operationId": "getMemberById", "parameters": [{"name": "memberId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseMemberResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/members/history/{memberId}": {"get": {"tags": ["member-controller"], "summary": "멤버 로그인 기록 조회", "description": "조회 결과", "operationId": "getLoginMemberHistory", "parameters": [{"name": "memberId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListMemberLoginEvent"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/memberCoupon/me": {"get": {"tags": ["member-coupon-controller"], "summary": "쿠폰 목록 조회", "description": "사용자의 쿠폰 목록을 조회합니다.", "operationId": "getMemberCouponList", "parameters": [{"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListMemberCouponResponseDto"}}}}}}}, "/api/item/populars": {"get": {"tags": ["item-controller"], "summary": "인기 상품 조회", "description": "판매순으로 10개씩 조회합니다.", "operationId": "popularItems", "parameters": [{"name": "limit", "in": "query", "required": false, "schema": {"type": "integer", "format": "int32", "default": 10}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/coupon/{couponId}": {"get": {"tags": ["coupon-controller"], "summary": "쿠폰 단건 조회", "description": "한 쿠폰의 정보를 조회합니다.", "operationId": "getCouponById", "parameters": [{"name": "couponId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseCouponResponseDto"}}}}}}}, "/api/chat-messages/{roomId}/messages": {"get": {"tags": ["chat-message-rest-controller"], "summary": "메시지 목록 조회", "description": "상담 채팅방 메시지 목록을 조회합니다.", "operationId": "getMessages", "parameters": [{"name": "roomId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "lastMessageId", "in": "query", "required": false, "schema": {"type": "integer", "format": "int64"}}, {"name": "pageSize", "in": "query", "required": false, "schema": {"type": "integer", "format": "int32", "default": 20}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseSliceChatMessageResponseDto"}}}}}}}, "/api/categories/{categoryId}/path": {"get": {"tags": ["category-controller"], "summary": "카테고리 경로 목록", "description": "상위 카테고리부터 하위 카테고리를 조회합니다.", "operationId": "getCategoryPath", "parameters": [{"name": "categoryId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCategoryPathDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/categories/{categoryId}/children": {"get": {"tags": ["category-controller"], "summary": "하위 카테고리 조회", "description": "조회 결과", "operationId": "getCategoryChildren", "parameters": [{"name": "categoryId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCategoryResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/carts/me/exists": {"get": {"tags": ["cart-controller"], "summary": "장바구니 존재 확인", "description": "멤버에 장바구니가 존재하는 지 확인합니다.", "operationId": "checkCartExists", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseBoolean"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/cart-items/me": {"get": {"tags": ["cart-item-controller"], "summary": "장바구니 목록 조회", "description": "자신의 장바구니 상품 목록을 조회합니다.", "operationId": "getMyCartItems", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseListCartItemResponseDto"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/cart-items/me/total-price": {"get": {"tags": ["cart-item-controller"], "summary": "장바구니 총 금액 계산", "description": "장바구니에 담긴 상품의 총 금액을 계산합니다.", "operationId": "getTotalCartPrice", "parameters": [{"name": "user", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK", "content": {"*/*": {"schema": {"$ref": "#/components/schemas/ApiResponseInteger"}}}}}, "security": [{"Bearer Authentication": []}]}}, "/api/categories/{categoryId}": {"delete": {"tags": ["category-controller"], "summary": "카테고리 삭제", "description": "관리자 전용입니다.", "operationId": "deleteCategory", "parameters": [{"name": "categoryId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/carts/{memberId}": {"delete": {"tags": ["cart-controller"], "summary": "장바구니 삭제", "description": "장바구니를 삭제합니다. 회원 삭제 시 적용됩니다.", "operationId": "deleteCart", "parameters": [{"name": "memberId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}, "/api/cart-items/me/items/{itemOptionId}": {"delete": {"tags": ["cart-item-controller"], "summary": "장바구니 상품 삭제", "description": "장바구니에 담겨있는 상품을 삭제합니다.", "operationId": "deleteCartItem", "parameters": [{"name": "itemOptionId", "in": "path", "required": true, "schema": {"type": "integer", "format": "int64"}}, {"name": "customUserDetails", "in": "query", "required": true, "schema": {"$ref": "#/components/schemas/CustomUserDetails"}}], "responses": {"200": {"description": "OK"}}, "security": [{"Bearer Authentication": []}]}}}, "components": {"schemas": {"ReviewRequestDto": {"type": "object", "properties": {"rating": {"type": "integer", "format": "int64"}, "content": {"type": "string"}, "item": {"type": "integer", "format": "int64"}}}, "ApiBodyReviewResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/ReviewResponseDto"}}}, "ApiHeader": {"type": "object", "properties": {"status": {"type": "string", "enum": ["100 CONTINUE", "101 SWITCHING_PROTOCOLS", "102 PROCESSING", "103 EARLY_HINTS", "103 CHECKPOINT", "200 OK", "201 CREATED", "202 ACCEPTED", "203 NON_AUTHORITATIVE_INFORMATION", "204 NO_CONTENT", "205 RESET_CONTENT", "206 PARTIAL_CONTENT", "207 MULTI_STATUS", "208 ALREADY_REPORTED", "226 IM_USED", "300 MULTIPLE_CHOICES", "301 MOVED_PERMANENTLY", "302 FOUND", "302 MOVED_TEMPORARILY", "303 SEE_OTHER", "304 NOT_MODIFIED", "305 USE_PROXY", "307 TEMPORARY_REDIRECT", "308 PERMANENT_REDIRECT", "400 BAD_REQUEST", "401 UNAUTHORIZED", "402 PAYMENT_REQUIRED", "403 FORBIDDEN", "404 NOT_FOUND", "405 METHOD_NOT_ALLOWED", "406 NOT_ACCEPTABLE", "407 PROXY_AUTHENTICATION_REQUIRED", "408 REQUEST_TIMEOUT", "409 CONFLICT", "410 GONE", "411 LENGTH_REQUIRED", "412 PRECONDITION_FAILED", "413 PAYLOAD_TOO_LARGE", "413 REQUEST_ENTITY_TOO_LARGE", "414 URI_TOO_LONG", "414 REQUEST_URI_TOO_LONG", "415 UNSUPPORTED_MEDIA_TYPE", "416 REQUESTED_RANGE_NOT_SATISFIABLE", "417 EXPECTATION_FAILED", "418 I_AM_A_TEAPOT", "419 INSUFFICIENT_SPACE_ON_RESOURCE", "420 METHOD_FAILURE", "421 DESTINATION_LOCKED", "422 UNPROCESSABLE_ENTITY", "423 LOCKED", "424 FAILED_DEPENDENCY", "425 TOO_EARLY", "426 UPGRADE_REQUIRED", "428 PRECONDITION_REQUIRED", "429 TOO_MANY_REQUESTS", "431 REQUEST_HEADER_FIELDS_TOO_LARGE", "451 UNAVAILABLE_FOR_LEGAL_REASONS", "500 INTERNAL_SERVER_ERROR", "501 NOT_IMPLEMENTED", "502 BAD_GATEWAY", "503 SERVICE_UNAVAILABLE", "504 GATEWAY_TIMEOUT", "505 HTTP_VERSION_NOT_SUPPORTED", "506 VARIANT_ALSO_NEGOTIATES", "507 INSUFFICIENT_STORAGE", "508 LOOP_DETECTED", "509 BANDWIDTH_LIMIT_EXCEEDED", "510 NOT_EXTENDED", "511 NETWORK_AUTHENTICATION_REQUIRED"]}, "code": {"type": "string"}}}, "ApiResponseReviewResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyReviewResponseDto"}}}, "ReviewResponseDto": {"type": "object", "properties": {"reviewId": {"type": "integer", "format": "int64"}, "memberId": {"type": "integer", "format": "int64"}, "rating": {"type": "integer", "format": "int64"}, "content": {"type": "string"}, "itemId": {"type": "integer", "format": "int64"}}}, "ItemImgRequestDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "itemId": {"type": "integer", "format": "int64"}, "imgType": {"type": "string", "enum": ["REPRESENTATIVE", "SUB"]}}}, "ItemOptionRequestDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "description": {"type": "string"}, "additionalPrice": {"type": "integer", "format": "int32"}, "stock": {"type": "integer", "format": "int32"}}}, "ItemUpdateRequestDto": {"type": "object", "properties": {"itemName": {"type": "string"}, "price": {"type": "integer", "format": "int32"}, "discount": {"type": "integer", "format": "int32"}, "deliveryFee": {"type": "integer", "format": "int32"}, "origin": {"type": "string"}, "itemLimit": {"type": "integer", "format": "int32"}, "existingItemImgs": {"type": "array", "items": {"$ref": "#/components/schemas/ItemImgRequestDto"}}, "existingItemOptions": {"type": "array", "items": {"$ref": "#/components/schemas/ItemOptionRequestDto"}}, "existingCategoryIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}, "addItemImgs": {"type": "array", "items": {"$ref": "#/components/schemas/ItemImgRequestDto"}}, "addItemOptions": {"type": "array", "items": {"$ref": "#/components/schemas/ItemOptionRequestDto"}}, "addCategoryIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}, "deleteImgIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}, "deleteOptionIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}, "deleteCategoryIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}}}, "ApiBodyItemResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/ItemResponseDto"}}}, "ApiResponseItemResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyItemResponseDto"}}}, "ItemImgResponseDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "imgName": {"type": "string"}, "oriImgName": {"type": "string"}, "imgUrl": {"type": "string"}, "imgType": {"type": "string", "enum": ["REPRESENTATIVE", "SUB"]}}}, "ItemOptionResponseDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "optionNo": {"type": "integer", "format": "int32"}, "description": {"type": "string"}, "additionalPrice": {"type": "integer", "format": "int32"}, "stock": {"type": "integer", "format": "int32"}}}, "ItemResponseDto": {"type": "object", "properties": {"itemName": {"type": "string"}, "price": {"type": "integer", "format": "int32"}, "discount": {"type": "integer", "format": "int32"}, "deliveryFee": {"type": "integer", "format": "int32"}, "categoryId": {"type": "integer", "format": "int64"}, "origin": {"type": "string"}, "itemLimit": {"type": "integer", "format": "int32"}, "itemState": {"type": "string", "enum": ["SELL", "STOP"]}, "email": {"type": "string"}, "categoryNames": {"type": "array", "items": {"type": "string"}}, "imgResponseDto": {"type": "array", "items": {"$ref": "#/components/schemas/ItemImgResponseDto"}}, "optionResponseDto": {"type": "array", "items": {"$ref": "#/components/schemas/ItemOptionResponseDto"}}, "id": {"type": "integer", "format": "int64"}}}, "CustomUserDetails": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "email": {"type": "string"}, "password": {"type": "string"}, "authorities": {"type": "array", "items": {"$ref": "#/components/schemas/GrantedAuthority"}}, "memberState": {"type": "string", "enum": ["QUIT", "ACTIVE", "SUSPENDED"]}, "lastPasswordChange": {"type": "string", "format": "date-time"}, "username": {"type": "string"}, "accountNonExpired": {"type": "boolean"}, "credentialsNonExpired": {"type": "boolean"}, "accountNonLocked": {"type": "boolean"}, "enabled": {"type": "boolean"}}}, "GrantedAuthority": {"type": "object", "properties": {"authority": {"type": "string"}}}, "Address": {"type": "object", "properties": {"city": {"type": "string"}, "street": {"type": "string"}, "zipCode": {"type": "string"}}}, "OrderItemRequestDto": {"type": "object", "properties": {"item": {"type": "integer", "format": "int64"}, "optionId": {"type": "integer", "format": "int64"}, "additionalPrice": {"type": "integer", "format": "int32"}, "quantity": {"type": "integer", "format": "int32"}}}, "OrderRequestDto": {"required": ["address", "orderItemRequestDtoList"], "type": "object", "properties": {"address": {"$ref": "#/components/schemas/Address"}, "deliveryRequest": {"type": "string"}, "orderItemRequestDtoList": {"type": "array", "items": {"$ref": "#/components/schemas/OrderItemRequestDto"}}, "memberCouponId": {"type": "integer", "format": "int64"}, "discountFromCoupon": {"type": "integer", "format": "int32"}, "usePoint": {"type": "integer", "format": "int32"}}}, "ApiBodyOrderResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/OrderResponseDto"}}}, "ApiResponseOrderResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyOrderResponseDto"}}}, "OrderItemResponseDto": {"type": "object", "properties": {"itemName": {"type": "string"}, "price": {"type": "integer", "format": "int32"}, "additionalPrice": {"type": "integer", "format": "int32"}, "discountRate": {"type": "integer", "format": "int32"}, "origin": {"type": "string"}, "quantity": {"type": "integer", "format": "int32"}}}, "OrderResponseDto": {"type": "object", "properties": {"orderId": {"type": "integer", "format": "int64"}, "orderState": {"type": "string", "enum": ["NEW", "PROCESSING", "SHIPPED", "CANCELLED", "COMPLETED"]}, "deliveryRequest": {"type": "string"}, "address": {"$ref": "#/components/schemas/Address"}, "deliveryFee": {"type": "integer", "format": "int32"}, "totalPrice": {"type": "integer", "format": "int32"}, "discountFromCoupon": {"type": "integer", "format": "int32"}, "usePoint": {"type": "integer", "format": "int32"}, "finalPrice": {"type": "integer", "format": "int32"}, "orderItemResponseDto": {"type": "array", "items": {"$ref": "#/components/schemas/OrderItemResponseDto"}}}}, "MemberRequestDto": {"required": ["email", "memberName", "memberPwd", "tel"], "type": "object", "properties": {"email": {"type": "string"}, "memberName": {"maxLength": 50, "minLength": 0, "type": "string"}, "memberPwd": {"type": "string"}, "tel": {"type": "string"}}}, "ApiBodyMemberResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/MemberResponseDto"}}}, "ApiResponseMemberResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyMemberResponseDto"}}}, "MemberResponseDto": {"type": "object", "properties": {"memberId": {"type": "integer", "format": "int64"}, "email": {"type": "string"}, "memberName": {"type": "string"}, "tel": {"type": "string"}, "role": {"type": "string", "enum": ["MEMBER", "ADMIN"]}, "memberState": {"type": "string", "enum": ["QUIT", "ACTIVE", "SUSPENDED"]}, "point": {"type": "integer", "format": "int32"}, "createdAt": {"type": "string", "format": "date-time"}, "lastPasswordChange": {"type": "string", "format": "date-time"}, "lastLogin": {"type": "string", "format": "date-time"}}}, "ApiBodyMemberCouponResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/MemberCouponResponseDto"}}}, "ApiResponseMemberCouponResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyMemberCouponResponseDto"}}}, "MemberCouponResponseDto": {"type": "object", "properties": {"memberCouponId": {"type": "integer", "format": "int64"}, "memberId": {"type": "integer", "format": "int64"}, "couponId": {"type": "integer", "format": "int64"}, "state": {"type": "string", "enum": ["AVAILABLE", "USED", "EXPIRED", "CANCELLED"]}, "issuedAt": {"type": "string", "format": "date"}, "usedAt": {"type": "string", "format": "date"}, "expiredAt": {"type": "string", "format": "date"}}}, "ItemRequestDto": {"type": "object", "properties": {"itemName": {"type": "string"}, "price": {"type": "integer", "format": "int32"}, "discount": {"type": "integer", "format": "int32"}, "deliveryFee": {"type": "integer", "format": "int32"}, "origin": {"type": "string"}, "itemLimit": {"type": "integer", "format": "int32"}, "categoryIds": {"type": "array", "items": {"type": "integer", "format": "int64"}}, "itemImgRequestDto": {"type": "array", "items": {"$ref": "#/components/schemas/ItemImgRequestDto"}}, "itemOptionRequestDto": {"type": "array", "items": {"$ref": "#/components/schemas/ItemOptionRequestDto"}}}}, "ItemSearchRequestDto": {"type": "object", "properties": {"page": {"type": "integer", "format": "int32"}, "size": {"type": "integer", "format": "int32"}, "direction": {"type": "string", "enum": ["ASC", "DESC"]}, "sortBy": {"type": "string"}, "itemName": {"type": "string"}, "categoryId": {"type": "integer", "format": "int64"}}}, "ApiBodyPageItemSearchResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/PageItemSearchResponseDto"}}}, "ApiResponsePageItemSearchResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyPageItemSearchResponseDto"}}}, "ItemSearchResponseDto": {"type": "object", "properties": {"itemName": {"type": "string"}, "price": {"type": "integer", "format": "int32"}, "discount": {"type": "integer", "format": "int32"}, "deliveryFee": {"type": "integer", "format": "int32"}, "categoryId": {"type": "integer", "format": "int64"}, "itemState": {"type": "string", "enum": ["SELL", "STOP"]}}}, "PageItemSearchResponseDto": {"type": "object", "properties": {"totalPages": {"type": "integer", "format": "int32"}, "totalElements": {"type": "integer", "format": "int64"}, "pageable": {"$ref": "#/components/schemas/PageableObject"}, "first": {"type": "boolean"}, "last": {"type": "boolean"}, "size": {"type": "integer", "format": "int32"}, "content": {"type": "array", "items": {"$ref": "#/components/schemas/ItemSearchResponseDto"}}, "number": {"type": "integer", "format": "int32"}, "sort": {"$ref": "#/components/schemas/SortObject"}, "numberOfElements": {"type": "integer", "format": "int32"}, "empty": {"type": "boolean"}}}, "PageableObject": {"type": "object", "properties": {"paged": {"type": "boolean"}, "pageNumber": {"type": "integer", "format": "int32"}, "pageSize": {"type": "integer", "format": "int32"}, "unpaged": {"type": "boolean"}, "offset": {"type": "integer", "format": "int64"}, "sort": {"$ref": "#/components/schemas/SortObject"}}}, "SortObject": {"type": "object", "properties": {"sorted": {"type": "boolean"}, "unsorted": {"type": "boolean"}, "empty": {"type": "boolean"}}}, "CouponRequestDto": {"required": ["discountValue", "name", "type", "validFrom", "validTo"], "type": "object", "properties": {"name": {"type": "string"}, "type": {"type": "string", "enum": ["FIXED", "RATE"]}, "discountValue": {"type": "integer", "format": "int32"}, "maxDiscountAmount": {"type": "integer", "format": "int32"}, "minOrderPrice": {"type": "integer", "format": "int32"}, "couponCount": {"type": "integer", "format": "int32"}, "validFrom": {"type": "string", "format": "date"}, "validTo": {"type": "string", "format": "date"}}}, "ApiBodyCouponResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/CouponResponseDto"}}}, "ApiResponseCouponResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyCouponResponseDto"}}}, "CouponResponseDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "name": {"type": "string"}, "type": {"type": "string", "enum": ["FIXED", "RATE"]}, "discountValue": {"type": "integer", "format": "int32"}, "maxDiscountAmount": {"type": "integer", "format": "int32"}, "minOrderPrice": {"type": "integer", "format": "int32"}, "validFrom": {"type": "string", "format": "date"}, "validTo": {"type": "string", "format": "date"}, "createdAt": {"type": "string", "format": "date-time"}}}, "ApiBodyVoid": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "object"}}}, "ApiResponseVoid": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyVoid"}}}, "ApiBodyChatRoomResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/ChatRoomResponseDto"}}}, "ApiResponseChatRoomResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyChatRoomResponseDto"}}}, "ChatRoomResponseDto": {"type": "object", "properties": {"roomId": {"type": "integer", "format": "int64"}, "customerId": {"type": "integer", "format": "int64"}, "agentId": {"type": "integer", "format": "int64"}, "active": {"type": "boolean"}}}, "CategoryRequestDto": {"type": "object", "properties": {"parentCategoryId": {"type": "integer", "format": "int64"}, "name": {"type": "string"}, "depth": {"type": "integer", "format": "int32"}}}, "ApiBodyCategoryResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/CategoryResponseDto"}}}, "ApiResponseCategoryResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyCategoryResponseDto"}}}, "CategoryResponseDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "parentCategoryId": {"type": "integer", "format": "int64"}, "name": {"type": "string"}, "depth": {"type": "integer", "format": "int32"}, "children": {"type": "array", "items": {"$ref": "#/components/schemas/CategoryResponseDto"}, "nullable": true}}}, "ApiBodyCartResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/CartResponseDto"}}}, "ApiResponseCartResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyCartResponseDto"}}}, "CartItemResponseDto": {"type": "object", "properties": {"cartId": {"type": "integer", "format": "int64"}, "quantity": {"type": "integer", "format": "int32"}, "itemId": {"type": "integer", "format": "int64"}, "optionId": {"type": "integer", "format": "int64"}}}, "CartResponseDto": {"type": "object", "properties": {"id": {"type": "integer", "format": "int64"}, "cartItems": {"type": "array", "items": {"$ref": "#/components/schemas/CartItemResponseDto"}}}}, "CartItemRequestDto": {"required": ["itemId", "quantity"], "type": "object", "properties": {"itemId": {"type": "integer", "format": "int64"}, "quantity": {"type": "integer", "format": "int32"}, "optionId": {"type": "integer", "format": "int64"}}}, "ApiBodyCartItemResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/CartItemResponseDto"}}}, "ApiResponseCartItemResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyCartItemResponseDto"}}}, "ApiBodyListCartItemResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/CartItemResponseDto"}}}}, "ApiResponseListCartItemResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListCartItemResponseDto"}}}, "TokenDto": {"type": "object", "properties": {"grantType": {"type": "string"}, "accessToken": {"type": "string"}, "refreshToken": {"type": "string"}}}, "OrderCancelRequestDto": {"type": "object", "properties": {"orderId": {"type": "integer", "format": "int64"}, "cancelReason": {"type": "string"}}}, "ApiBodyOrderCancelResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/OrderCancelResponseDto"}}}, "ApiResponseOrderCancelResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyOrderCancelResponseDto"}}}, "OrderCancelResponseDto": {"type": "object", "properties": {"orderId": {"type": "integer", "format": "int64"}, "cancelReason": {"type": "string"}}}, "ApiBodyString": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "string"}}}, "ApiResponseString": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyString"}}}, "ApiBodyInteger": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "integer", "format": "int32"}}}, "ApiResponseInteger": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyInteger"}}}, "ApiBodyListDailySalesDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/DailySalesDto"}}}}, "ApiResponseListDailySalesDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListDailySalesDto"}}}, "DailySalesDto": {"type": "object", "properties": {"date": {"type": "string", "format": "date"}, "totalSales": {"type": "integer", "format": "int64"}, "totalRevenue": {"type": "integer", "format": "int64"}}}, "ApiBodyListTopItemDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/TopItemDto"}}}}, "ApiResponseListTopItemDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListTopItemDto"}}}, "TopItemDto": {"type": "object", "properties": {"itemId": {"type": "integer", "format": "int64"}, "itemName": {"type": "string"}, "totalSold": {"type": "integer", "format": "int32"}, "totalRevenue": {"type": "integer", "format": "int32"}, "lastOrderDate": {"type": "string", "format": "date-time"}}}, "Pageable": {"type": "object", "properties": {"page": {"minimum": 0, "type": "integer", "format": "int32"}, "size": {"minimum": 1, "type": "integer", "format": "int32"}, "sort": {"type": "array", "items": {"type": "string"}}}}, "ApiBodyPageReviewResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/PageReviewResponseDto"}}}, "ApiResponsePageReviewResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyPageReviewResponseDto"}}}, "PageReviewResponseDto": {"type": "object", "properties": {"totalPages": {"type": "integer", "format": "int32"}, "totalElements": {"type": "integer", "format": "int64"}, "pageable": {"$ref": "#/components/schemas/PageableObject"}, "first": {"type": "boolean"}, "last": {"type": "boolean"}, "size": {"type": "integer", "format": "int32"}, "content": {"type": "array", "items": {"$ref": "#/components/schemas/ReviewResponseDto"}}, "number": {"type": "integer", "format": "int32"}, "sort": {"$ref": "#/components/schemas/SortObject"}, "numberOfElements": {"type": "integer", "format": "int32"}, "empty": {"type": "boolean"}}}, "ApiBodyPayment": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/Payment"}}}, "ApiResponsePayment": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyPayment"}}}, "Payment": {"type": "object", "properties": {"channel": {"type": "string"}, "escrow": {"type": "boolean"}, "name": {"type": "string"}, "amount": {"type": "number"}, "currency": {"type": "string"}, "status": {"type": "string"}, "cancelReason": {"type": "string"}, "merchantUid": {"type": "string"}, "cashReceiptIssued": {"type": "boolean"}, "customerUidUsage": {"type": "string"}, "bankCode": {"type": "string"}, "bankName": {"type": "string"}, "cardCode": {"type": "string"}, "pgProvider": {"type": "string"}, "cardNumber": {"type": "string"}, "applyNum": {"type": "string"}, "cardQuota": {"type": "integer", "format": "int32"}, "cardName": {"type": "string"}, "impUid": {"type": "string"}, "payMethod": {"type": "string"}, "pgTid": {"type": "string"}, "embPgProvider": {"type": "string"}, "receiptUrl": {"type": "string"}, "customerUid": {"type": "string"}, "vbankIssuedAt": {"type": "integer", "format": "int64"}, "buyerPostcode": {"type": "string"}, "vbankCode": {"type": "string"}, "cancelHistory": {"type": "array", "items": {"$ref": "#/components/schemas/PaymentCancelDetail"}}, "startedAt": {"type": "integer", "format": "int64"}, "customData": {"type": "string"}, "buyerTel": {"type": "string"}, "vbankName": {"type": "string"}, "vbankDate": {"type": "string", "format": "date-time"}, "failedAt": {"type": "string", "format": "date-time"}, "vbankNum": {"type": "string"}, "buyerAddr": {"type": "string"}, "cancelledAt": {"type": "string", "format": "date-time"}, "buyerEmail": {"type": "string"}, "cardType": {"type": "integer", "format": "int32"}, "buyerName": {"type": "string"}, "vbankHolder": {"type": "string"}, "cancelAmount": {"type": "number"}, "paidAt": {"type": "string", "format": "date-time"}, "failReason": {"type": "string"}}}, "PaymentCancelDetail": {"type": "object", "properties": {"amount": {"type": "number"}, "reason": {"type": "string"}, "pgTid": {"type": "string"}, "receiptUrl": {"type": "string"}, "cancelledAt": {"type": "integer", "format": "int64"}}}, "ApiBodyPageOrderResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/PageOrderResponseDto"}}}, "ApiResponsePageOrderResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyPageOrderResponseDto"}}}, "PageOrderResponseDto": {"type": "object", "properties": {"totalPages": {"type": "integer", "format": "int32"}, "totalElements": {"type": "integer", "format": "int64"}, "pageable": {"$ref": "#/components/schemas/PageableObject"}, "first": {"type": "boolean"}, "last": {"type": "boolean"}, "size": {"type": "integer", "format": "int32"}, "content": {"type": "array", "items": {"$ref": "#/components/schemas/OrderResponseDto"}}, "number": {"type": "integer", "format": "int32"}, "sort": {"$ref": "#/components/schemas/SortObject"}, "numberOfElements": {"type": "integer", "format": "int32"}, "empty": {"type": "boolean"}}}, "ApiBodyListMemberResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/MemberResponseDto"}}}}, "ApiResponseListMemberResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListMemberResponseDto"}}}, "ApiBodyListMemberLoginEvent": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/MemberLoginEvent"}}}}, "ApiResponseListMemberLoginEvent": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListMemberLoginEvent"}}}, "MemberLoginEvent": {"type": "object", "properties": {"memberId": {"type": "integer", "format": "int64"}, "loginDt": {"type": "string", "format": "date-time"}, "ipAddress": {"type": "string"}, "device": {"type": "string"}}}, "ApiBodyListMemberCouponResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/MemberCouponResponseDto"}}}}, "ApiResponseListMemberCouponResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListMemberCouponResponseDto"}}}, "ApiBodyListItemResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/ItemResponseDto"}}}}, "ApiResponseListItemResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListItemResponseDto"}}}, "ApiBodyListCouponResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/CouponResponseDto"}}}}, "ApiResponseListCouponResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListCouponResponseDto"}}}, "ApiBodySliceChatMessageResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"$ref": "#/components/schemas/SliceChatMessageResponseDto"}}}, "ApiResponseSliceChatMessageResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodySliceChatMessageResponseDto"}}}, "ChatMessageResponseDto": {"type": "object"}, "SliceChatMessageResponseDto": {"type": "object", "properties": {"pageable": {"$ref": "#/components/schemas/PageableObject"}, "first": {"type": "boolean"}, "last": {"type": "boolean"}, "size": {"type": "integer", "format": "int32"}, "content": {"type": "array", "items": {"$ref": "#/components/schemas/ChatMessageResponseDto"}}, "number": {"type": "integer", "format": "int32"}, "sort": {"$ref": "#/components/schemas/SortObject"}, "numberOfElements": {"type": "integer", "format": "int32"}, "empty": {"type": "boolean"}}}, "ApiBodyListCategoryResponseDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/CategoryResponseDto"}}}}, "ApiResponseListCategoryResponseDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListCategoryResponseDto"}}}, "ApiBodyListCategoryPathDto": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "array", "items": {"$ref": "#/components/schemas/CategoryPathDto"}}}}, "ApiResponseListCategoryPathDto": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyListCategoryPathDto"}}}, "CategoryPathDto": {"type": "object", "properties": {"parentCategoryId": {"type": "integer", "format": "int64"}, "name": {"type": "string"}, "id": {"type": "integer", "format": "int64"}}}, "ApiBodyBoolean": {"type": "object", "properties": {"message": {"type": "string"}, "timestamp": {"type": "string", "format": "date-time"}, "data": {"type": "boolean"}}}, "ApiResponseBoolean": {"type": "object", "properties": {"header": {"$ref": "#/components/schemas/ApiHeader"}, "body": {"$ref": "#/components/schemas/ApiBodyBoolean"}}}}, "securitySchemes": {"Bearer Authentication": {"type": "http", "scheme": "bearer", "bearerFormat": "JWT"}}}};
      const ui = SwaggerUIBundle({ spec: spec, dom_id: '#swagger-ui' });
      window.ui = ui;
    };
  </script>
</body>
</html>
)


# 겪은 문제 및 고민(트러블 슈팅)

## 공통 응답
ResponseEntity<>를 사용하여 Http 응답 메시지를 구성하고,
ApiResponse 공통 응답 객체를 통해서 상태 메시지와 데이터를 분리하여 JSON으로 보내는 쪽으로 구상하였다.
처음엔 ResponseEntity<?>의 구조로 와일드카드 문자를 이용하는 것이 편했으나, 
데이터 구조에 맞게 보내는 것이 맞다고 판단해서 ResponseEntity<ApiResponse<DTO>>> 와 같이 DTO 객체를 보내는 방식으로 변경하였다.

## 상품과 카테고리 구조에 대하여
기본적으로 쇼핑몰의 구조는 다양한데 그 중에서 하나의 상품에 여러 옵션이 있는 경우를 채택했다.
만약에 Item에 Option이 존재한다면 중복 데이터가 많아진다고 판단, 정규화가 필요하다고 생각해서 상품과 옵션을 분리하여 관리했다.
Item 쪽에서는 기본적인 상품명과 기본값, 배송비, 원산지 등의 정보를 보유한다.
Option 쪽에서는 Option에 따른 추가금을 부여하며, 수량을 관리해서 Option의 모든 수량이 0이 되면 상품이 매진처리된다.
카테고리 쪽에서는 Item과 연관관계를 맺고, 관계 테이블을 통해서 데이터 조회를 편하게 할 수 있게 설계하였다.
추후에 주문 쪽도 비슷한 구조를 지니게 되었다.

## 상품 이미지 관련 오류
상품 업로드 시에 추가적인 이미지를 업로드한다.
하나는 대표 이미지(썸네일), 나머지는 쇼핑몰에서 흔하게 볼 수 있는 상품 설명 이미지들이다.
처음에 막연하게 DTO에서 MultiPart를 사용했었는데, 굉장히 잘못된 구조였다..
기본적으로 DTO는 데이터 통신을 위한 틀인데, 이것이 스프링에 의존적인 구조가 된 것이다.
이미지 업로드는 서비스 쪽에서 처리하기 때문에 DTO에는 기본적인 이미지의 이름이나 타입 정보 변수만 선언하였다.

이렇게 다시 구조를 바꿔보니 기존 서비스 코드에서 이미지를 처리할 때 이게 상품과 맞는 이미지인지 어떻게 구분해야하지..?
단순히 반복문으로 순서에 맞춰서 이게 맞는 것인지 알 수 있는 건가? 라는 생각이 들었다.
Map 구조를 사용하면 Key 값에 맞춰 Value가 들어가기 때문에 그 문제를 해결할 수 있다고 생각했고, 적용하였다.
결론적으로 이미지 업로드 메소드는 Map<DTO(이미지의 정보, DB에 저장), IMAGE(실제 이미지, 파일로 저장)>같은 구조가 되었다.

## 상품 수정
상품 수정 시 낙관적 락 오류가 발생했다.
상품은 이미지, 카테고리, 옵션 등과 연관관계를 맺고 있기 때문에,
상품 ID를 기준으로 4개의 테이블에서 수정이 이루어져야 했다.
처음에 수정을 구현할 때, 각각의 테이블에서는 수정에 조금씩 다른 조건을 요구했다.
옵션은 삽입 / 삭제 말고도 자체적인 변경 감지가 필요했고,
이미지는 실제 파일의 삽입 / 삭제가 이루어져야 했다.
처음에 수정을 구현할 때 이 여러 가지의 요구사항을 하나의 메소드에서 구현했는데, 옵션 쪽에서 낙관적 락 오류가 발생했다.
그래서 기존의 요소 수정(updateExist), 새로운 옵션 삽입(newOption), 옵션 삭제(deleteOption)의 작업을 메소드로 분리한 다음
update 메소드에서 이 3가지의 메소드를 불러오는 방식으로 처리하여 낙관적 락 오류를 해결하였다.
기존 메서드에서는 하나의 메소드 안에서 연속적인 변경이 일어난 것 때문에 낙관적 락이 걸린 것으로 추정된다.
그래서 처음에 메소드를 각각의 트랜잭션으로 분리하는 방식으로 문제를 해결했는데, 만약 다른 트랜잭션에서 이미 커밋된 후 rollback이 일어난다면
데이터의 정합성이 깨질 것을 우려해서 한 메소드 안에 트랜잭션을 적용하였다.

## JPA N + 1 문제
대표적으로 생각나는 건 주문할 때 Order와 OrderItem쪽이고, 설계 시 주문과 주문상품 엔티티를 따로 만들었고, 연관관계를 통해서 관리했다.
만약에 주문 아이템 개수가 늘어나면, 늘어난 만큼 select 쿼리가 발생하는 n+1 문제가 발생하고, 주문 상품 개수가 늘어난다면 쿼리가 더 많이 실행되기 때문에 무조건 성능 저하의 원인이 된다.
FetchType.Lazy나, BatchSize 조절 등의 방법도 존재했지만, 대부분 Join 쿼리를 통해서 해결하였다.

## 시간 문제
데이터베이스에 자꾸 내가 저장한 시간과 다른 시간 정보가 들어갔다.
UTC 시간대를 사용하는 문제였다.
Properties에 Time_Zone을 Asia/Seoul로 바꿔주었다.

## 여러 스레드에서 동시에 주문이 들어온다면?
기본적인 주문 테스트 코드는 동작되었지만, 만약에 실제로 사용자가 몰리는 환경이라면 어떨까?
동시성 문제는 항상 대두되는 문제였기 때문에 테스트 코드에서 임의의 스레드를 10개 만들고 동시에 주문 요청을 해보았다.
당연히 트랜잭션에서 데드락이 발생하여 실패하였고, 이 동시성 문제는 쿼리 자체에서 비관적 락을 걸어서 해결하였다.

## 테스트 코드의 반복적인 사용
테스트 코드에서 공통적으로 사용되는 ObjectMapper나, MockMvc 테스트 도구 등이 모든 테스트 코드에서 사용되었다.
또한 멤버가 로그인 상태여야 하는 상품 등록이나 장바구니 테스트 코드들에서 모든 코드에 토큰 정보를 가져오는 코드를 일일히 쓸 필요는 없었다.
테스트 코드에서도 필요한 기본 정보를 미리 Setting Abstract Class로 분리하여 재사용성을 높였다.

## ArgumentResolver
토큰 정보와 관련되어서 설계 시에 애를 먹었던 부분이다.
기본적으로 토큰에는 '사용자를 식별할 수 있는 최소한의 정보를 담고, 서비스 로직에서 토큰 정보를 이용하여 조회한다'를 기본으로 커스텀 어노테이션을 만들고 싶었다.
스프링 자체적으로 UserDetails 기반의 @AuthenticationPrincipal 어노테이션을 제공하기는 하지만, CustomUserDetails을 통해서 멤버의 상태를 파악을 더 쉽게 할 수 있다고 생각했다.
loadByUserName에서 멤버의 로그인 가능 여부를 파악한 다음에 CustomUserDetails를 리턴하는 과정에서 DB와의 접촉을 하기 때문에,
토큰 생성 시에는 기본적인 멤버 식별자만 getPrincipal()을 통해서 가져와서 토큰을 생성하고, 서비스 로직에서 토큰의 식별자를 이용해서 현재 로그인 된 멤버를 파악하고, 비즈니스 로직에 접근하였다.

# 개발하면서..

## 클린 코드?
'비즈니스 로직은 순수해야 한다' 를 바탕으로, 가독성 좋은 코드를 작성하는 것도 어려운 일이라고 생각한다.
본인이 작성하기 편하게 처음에 구조를 짜는 게 정말 중요한 것 같다.
컨트롤러 쪽 코드는 굉장히 단순하게, 서비스 쪽에서는 깔끔하고 잘 동작할 수 있게 노력을 기울였다.
서비스 쪽에서 일단 기능을 구현해보고 하나의 코드에 너무 많은 역할이 주어진다고 싶으면 일단 리팩토링을 하는 쪽으로 프로젝트를 개발하였다.

## DB 구조를 어떻게 해야할까?
처음에 좋은 ERD를 다이어그램을 설계하는 게 맞다고 생각하지만,
생각보다 그게 쉽지 않기도 하고, 개발 진행 시에 계속해서 DB 구조를 바꿔야 할 일이 생긴다.

## 추가할만한 요소?
추천 상품이나, 쿠폰 시스템 같은 것도 추가해볼만하다고 생각한다.
